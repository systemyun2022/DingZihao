

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/lib/bootstrap/dist/css/bootstrap.min.css" />
    <script src="/js/jquery.min.js"></script>
</head>

<h4>提交任务: &#x7E41;&#x534E;&#x724C;-&#x514D;&#x8D39;&#x62C9;&#x6EE1;-&#x9886;&#x53D6;qq&#x7FA4;684571310-&#x9886;&#x53D6;&#x5730;&#x5740;&#x5728;&#x7FA4;&#x516C;&#x544A;.</h4>


<div class="card-columns" style="margin-top:10px">
    
    <form method="post" id="formMain" onsubmit="return confirm('是否已经卸载游戏？否则可能不到帐');">

        <input class="form-control" hidden="hidden" type="text" data-val="true" data-val-maxlength="The field PubSerial must be a string or array type with a maximum length of &#x27;150&#x27;." data-val-maxlength-max="150" id="TaskInfo_PubSerial" maxlength="150" name="TaskInfo.PubSerial" value="CDD27A01D68D3E70DEBC759B0A2BAB5349052982A822F7C24A9B27B7146A1090FC8CE6E85A75B8B3E242210A7B6FDF0E" />
            <div class="card bg-light">
              <div class="card-body">
                <div class="card-header text-center">
                    <label class="control-label">充值步骤</label>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">第0步 选择平台(苹果或者安卓)</li>
                    <li class="list-group-item">第1步 输入手机号并点获取验证码</li>
                    <li class="list-group-item">第2步 输入短信验证码</li>
                    <li class="list-group-item" style="color:darkred">第3步 卸载游戏</li>
                    <li class="list-group-item">第4步 点击“提交”按钮</li>
                    <li class="list-group-item" style="color:darkgreen">第5步 等待到帐(刷新页面查看状态)</li>
                    <li class="list-group-item">第6步 重新登录游戏</li>
                </ul>
              </div>
            </div>

        <div class="card bg-light">
            <div class="card-header text-center">
                <label class="control-label">账号信息</label>
            </div>
            <div class="card-body text-center">
                <div id="divErr" style="color:red;display: none"></div>
                <div id="divSuccess" style="color:green;display: none"></div>
                <div class="input-group mb-3">
                    <div class="form-group">
                        <label class="control-label" for="TaskInfo_Platform">&#x5E73;&#x53F0;</label>
                        <label style="margin-left:5px"><input id="Platform1" name="TaskInfo.Platform" type="radio" value="1">苹果</label>
                        <label style="margin-left:5px"><input id="Platform2" name="TaskInfo.Platform" type="radio" value="2">安卓</label>
                    </div>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">手机号</span>
                    </div>
                    <input class="form-control" min="0" type="text" data-val="true" data-val-maxlength="The field &#x624B;&#x673A;&#x53F7; must be a string or array type with a maximum length of &#x27;20&#x27;." data-val-maxlength-max="20" id="TaskInfo_Phone" maxlength="20" name="TaskInfo.Phone" value="" />
                    <span class="text-danger field-validation-valid" data-valmsg-for="TaskInfo.Phone" data-valmsg-replace="true"></span>
                    <button id="btnGetCode" type="button" class="form-control alert-primary">获取验证码</button>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">验证码</span>
                    </div>
                    <input class="form-control" min="0" type="text" data-val="true" data-val-maxlength="The field &#x9A8C;&#x8BC1;&#x7801; must be a string or array type with a maximum length of &#x27;20&#x27;." data-val-maxlength-max="20" id="TaskInfo_Code" maxlength="20" name="TaskInfo.Code" value="" />
                    <span class="text-danger field-validation-valid" data-valmsg-for="TaskInfo.Code" data-valmsg-replace="true"></span>
                </div>
            </div>
        </div>

           <div class="card bg-light">
                <div class="card-header text-center">
                    <label class="control-label">套餐内容</label>
                </div>
                <div class="card-body text-left">
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">+金币 (8 &#x5343;&#x4E07;)</span>
                        </div>
                        <input class="form-control" readonly="readonly" type="number" data-val="true" data-val-required="The &#x2B;&#x91D1;&#x5E01; field is required." id="TaskInfo_Coins" name="TaskInfo.Coins" value="80000000" />
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">+钥匙 (2 &#x4E07;)</span>
                        </div>
                        <input class="form-control" readonly="readonly" type="number" data-val="true" data-val-required="The &#x2B;&#x84DD;&#x94A5;&#x5319; field is required." id="TaskInfo_Keys" name="TaskInfo.Keys" value="20000" />
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">+滑板 (5 &#x5343;)</span>
                        </div>
                        <input class="form-control" readonly="readonly" type="number" data-val="true" data-val-required="The &#x2B;&#x6ED1;&#x677F; field is required." id="TaskInfo_Skids" name="TaskInfo.Skids" value="5000" />
                    </div>
                    <p>&#x6ED1;&#x677F;: (&#x6240;&#x6709;), &#x4EBA;&#x7269;: (&#x6240;&#x6709;), &#x5B9D;&#x7269;&#x94A5;&#x5319; (-1 &#x2B; 5 &#x4E07;), &#x8D85;&#x7EA7;&#x55B7;&#x5C04;&#x8D77;&#x8DD1; (-1 &#x2B; 5 &#x4E07;), &#x5F97;&#x5206;&#x500D;&#x589E; (-1 &#x2B; 6 &#x5343;&#x4E07;), &#x968F;&#x673A;&#x80CC;&#x9970; (-1 &#x2B; 16) &#x4E2A;, 10&#x500D;&#x79EF;&#x5206;, &#x70AB;&#x8DD1;&#x5361; 360 &#x5929;, &#x53CC;&#x500D;&#x91D1;&#x5E01;, &#x5168;&#x90E8;&#x5B9D;&#x7BB1;&#x5B9D;&#x7269;&#x6EE1;&#x7EA7;, &#x91CD;&#x7F6E;&#x5B9D;&#x7BB1;&#x62BD;&#x5956;&#x6B21;&#x6570;, </p>
                </div>
                    <div class="form-group" style="margin-left:30%">
                        <input type="submit" value="提交" class="btn btn-primary" />
                    </div>
            </div>
    <input name="__RequestVerificationToken" type="hidden" value="CfDJ8AM6C-dN8-RHhqLFu_OSBBC0lnGKnoL-WJ66ULBCkIXARw75ctWiRaD52k8Ia-qIrOwzDpKl-Lw_SR23v9z2goAHj8_QOvt8b9tYYvUw_eoXXgj9YdMtgHYrw3RRddqEHjUTXBKwpen2BzWA53pqDqA" /></form>
</div>

<script>
$(document).ready( function () {
        //var staticNotification = $("#staticNotification").data("kendoNotification");

        //function showAlert() {
        //    staticNotification.show("请输入跑号(游戏ID)", "错误");
        //    var container = $(staticNotification.options.appendTo);
        //    container.scrollTop(container[0].scrollHeight);
        //}
    });

    var sendSms = function (phoneNumber) {
        console.log('1234');
        var data = { Phone: phoneNumber };

        $.ajax({
            url: '/Subway/PubEx?handler=SendCode',
            data: {
                Phone: phoneNumber,
                ExtraInfo: $('input[name="TaskInfo.Platform"]:checked').val()
            }
        })
            .done(function (result) {
                if (result.code == 0) {
                    //  success
                    $('#divSuccess').text('发送验证码成功: ' + phoneNumber);
                    $('#divSuccess').show('');
                } else {
                    $('#divErr').text(result.message);
                    $('#divErr').show();
                }
            });
    };

    $("#btnGetCode").click(function () {
        $('#divErr').hide();
        $('#divSuccess').hide();

        var phone = $('#TaskInfo_Phone').val();
        if (phone == null || phone === '') {
            console.warn('No Phone');
            return;
        }

        if ($('input[name="TaskInfo.Platform"]:checked').val() == undefined) {
            alert('请选择平台(系统): 苹果 还是 安卓');
            return;
        }

        $("#btnGetCode").prop('disabled', true);
        var cnt = 60;
        var id = setInterval(function () {
            $("#btnGetCode").text('(' + cnt + ')秒后重试');
            cnt--;

            if (cnt <= 0) {
                clearInterval(id);
                $("#btnGetCode").text('获取验证码');
                $("#btnGetCode").prop('disabled', false);
            }
        }, 1000);

        sendSms(phone);
    });
</script>

